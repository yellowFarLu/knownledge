# 网络基础

不同硬件，操作系统之间需要进行通讯，都需要一种规则，这种规则称为**协议**。（比如说谁先发起通讯，怎么结束通讯）

Web使用HTTP（超文本传输协议）作为规范，完成从客户端到服务器端等一系列流程，Web是建立在HTTP上进行通讯的。



## TCP/IP协议族

通常使用的网络，是在TCP/IP协议族基础上进行运作的，而HTTP是它的子集。

![image-20190821222934324](http://ww3.sinaimg.cn/large/006y8mN6gy1g67o5vuh18j31b20pwkaj.jpg)



### 分层管理

TCP/IP协议族 按层次分为应用层、传输层、网络层、数据链路层。



**分层的好处**

- 解耦。当分层之后，并且规划好层与层之间交互的接口，如果某个层的设计有改动了，只需要替换该层，而其他地方不用改动。
- 职责分明。每个层次只需要负责自己的任务，而不用管下一层是怎么运作的。



####各层的职责

##### 应用层

应用层本质是**规定了应用程序之间如何传递报文**。比如说FTP（File Transfer Protocol  文本传输协议）、DNS（Domain Name System  域名系统），HTTP协议 都属于该层。



#####传输层

传输层为两台主机上的应用程序提供**端对端通讯**。 传输层为应用层提供服务。

传输层使用端口号来标识应用程序，主机在收到数据包以后，根据端口号判断数据包应该给哪个应用程序进行处理。比如说有个应用程序监听了80端口，那么端口是80的数据包就会被提交给该应用程序。

虽然叫做传输层，但他实际上的作用是对传输行为进行控制。为下面的两层协议**提供数据报的重传、流量控制**、拥塞控制等。

![image-20191001124837593](https://tva1.sinaimg.cn/large/006y8mN6gy1g7imofg1daj30we0lan3e.jpg)





##### 网络层

网络层提供了主机到主机的通讯，将传输层产生的数据包封装成**分组数据包**，发送到目标主机。并且提供路由选择能力。

数据包是网络传输的最小数据单位，该层规定了数据包通过怎样的路径到对方计算机。

![image-20191001124447124](https://tva1.sinaimg.cn/large/006y8mN6gy1g7imolwq8kj31120ey79o.jpg)

网关在网络层将不同的网络连接起来，使得不同网络的主机可以通信。





##### 链路层

又称为“数据链路层、网络接口层”

指连接网络的硬件部分，例如说光纤、网卡。

网桥在链路将不同的网络连接起来，使得不同网络的主机可以通信。





#### 数据在层之间传输

![image-20190821230109267](http://ww2.sinaimg.cn/large/006y8mN6gy1g67p2qouygj31330u04c5.jpg)

利用TCP/IP协议族进行通讯时，发送端从应用层往下走，接收端从网络层往上走。



![image-20190821230415084](http://ww2.sinaimg.cn/large/006y8mN6gy1g67p5zsnymj30yo0u0e3k.jpg)

- 发送端在层与层之间传输数据时，每经过一层，就会在数据中加上该层所属的首部信息。

- 接收端在层与层之间传输数据时，每经过一层，会在数据中删除上一层所属的首部信息。

- IP和网络接口层之间的传送单元是分组。分组既可以是IP数据报，也可以是IP数据报的一个片。



#### 分用

当目的主机收到一个以太网数据帧的时候，数据就从协议栈由底向上传送。同时去掉各层协议加上的报文首部。

每层一些都要检查报文首部中的协议标识，以确定接收数据的上层协议。这个过程称作“分用”。

![image-20200516134051304](https://tva1.sinaimg.cn/large/007S8ZIlgy1geu8kndj8mj313g0ogq7i.jpg)







#### 分层的好处

- 解耦，各层面向的是标准接口，而不用关注具体的实现



#### 唯一标识

分层结构中，每一层都有一个唯一标识，比如链路层的MAC地址，IP层的IP地址，传输层的端口号。









## URI和UIL

**URI用来唯一的标识一个资源**

URL表示**资源在互联网上的位置**，它是URI的具体表现形式，通过URL可以定位到资源。可见，URL是URI的子集。



**绝对URI**

![image-20190822100803349](http://ww2.sinaimg.cn/large/006y8mN6gy1g688cnhcccj30ld04ujts.jpg)











## 网络的网络

网络把主机连接起来，而互连网（internet）是把多种不同的网络连接起来，因此互连网是网络的网络。

互联网（Internet）是全球范围的互连网。

<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9g3hf6vmrj30p60guwmr.jpg" alt="image-20191130152510686" style="zoom:50%;" />



## ISP

互联网服务提供商 ISP 可以从互联网管理机构获得许多 IP 地址，同时拥有通信线路以及路由器等联网设备，个人或机构向 ISP 缴纳一定的费用就可以接入互联网。

<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9g3icc848j30s60c23zi.jpg" alt="image-20191130152603931" style="zoom:50%;" />

目前的互联网是一种多层次 ISP 结构，ISP 根据覆盖面积的大小分为第一层 ISP、区域 ISP 和接入 ISP。互联网交换点 IXP 允许两个 ISP 直接相连而不用经过第三个 ISP。

<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9g3ivlbf9j30rc0h0q5g.jpg" alt="image-20191130152632664" style="zoom:50%;" />





## 主机之间的通信方式

- 客户-服务器（C/S）：客户是服务的请求方，服务器是服务的提供方。

<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9g3jvhnshj30es0bu0uy.jpg" alt="image-20191130152731876" style="zoom:50%;" />



- 对等（P2P）：不区分客户和服务器。

<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9g3k968g1j30bw0b4gnx.jpg" alt="image-20191130152753747" style="zoom:50%;" />









## 扩展



### OSI七层网络协议

1. 应用层
   1. 为应用程序提供访问网络服务的接口
   2. 常见协议有：HTTP、DNS
2. 表示层
   1. 提供数据格式转换服务
   2. 比如说加密和解密、编码和解码
3. 会话层
   1. 建立端连接，提供访问验证和会话管理
   2. 比如说服务器验证用户登录
4. 传输层
   1. 建立应用之间的逻辑通信。如建立连接、超时重传
   2. 常见协议有TCP、UDP
5. 网络层
   1. 为数据在节点之间传输创建逻辑链路，并分组转发数据
   2. 常见IP协议、路由器
6. 链路层
   1. 在通讯实体之间创建数据链路链接
   2. 网桥、网卡
7. 物理层
   1. 为设备提供比特率传输的通路
   2. 如网线

![image-20200309152917676](https://tva1.sinaimg.cn/large/00831rSTgy1gcnpkl7rc4j30ox0hr7i1.jpg)













## 参考

[OSI七层协议大白话解读](https://blog.csdn.net/taotongning/article/details/81352985)

《图解HTTP》

[OSI网络七层协议](https://www.jianshu.com/p/f101efce37e2)

